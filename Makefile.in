LIBS = libdib/libdib.la @XPM_LIBS@ @LIBS@ -lm

GDLIBS = libdib/libdib.la xgd-1.7.3/libxgd.la @XPM_LIBS@ @LIBS@ @TTF_LIBS@ @PNG_CFLAGS@ @PNG_LIBS@ @ZLIB_LIBS@ -lm 

XFLIBS = libxfig/libxfig.la libdib/libdib.la @XPM_LIBS@ @LIBS@ @TTF_LIBS@ -lm

EPSLIBS = libxfig/libeps.la libdib/libdib.la @XPM_LIBS@ @LIBS@ @TTF_LIBS@ -lm

DOGD = @GD_LIBS@

LDFLAGS = @LDFLAGS@

CC = @CC@

SHELL=/bin/sh

INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@

INCLUDEDIR = @includedir@

prefix = @prefix@
exec_prefix = @exec_prefix@
srcdir = @srcdir@
bindir = @bindir@
libdir = @libdir@
mandir = @mandir@

CFLAGS = @CPPFLAGS@ @CFLAGS@ @DEFS@ -I. @XPM_CFLAGS@ -I./libxfig -I./libdib -I./xgd-1.7.3 @TTF_CFLAGS@

MKINSTALLDIRS = $(srcdir)/mkinstalldirs

SHELL = /bin/sh

.SUFFIXES:
.SUFFIXES: .c .o .lo

WMFLIBOBJECTS =	\
	wmfapi.lo \
	stack.lo \
	bytelevel.lo

GDLIBOBJECTS =	\
	gdwmfapi.lo \
	wmftt.lo

XFLIBOBJECTS =	\
	xfwmfapi.lo 

EPSLIBOBJECTS =	\
	xfwmfapi.lo 

XLIBOBJECTS =	\
	Xwmfapi.lo \
	Xtext.lo \
	rotated.lo

TARGETS = wmftopng wmftofig wmftoeps xwmf

all: $(TARGETS)

xwmf: libwmf.la libXwmf.la xwmf.o libdib/libdib.la
	./libtool $(CC) $(LDFLAGS) -o xwmf xwmf.o \
		libXwmf.la libwmf.la $(LIBS)

wmftopng:	libwmf.la libgdwmf.la wmftopng.o \
		xgd-1.7.3/libxgd.la libdib/libdib.la
	./libtool $(CC) $(LDFLAGS) -o wmftopng wmftopng.o \
		libgdwmf.la libwmf.la $(GDLIBS)

wmftofig: libwmf.la libxfwmf.la wmftofig.o libxfig/libxfig.la
	./libtool $(CC) $(LDFLAGS) -o wmftofig wmftofig.o \
		libxfwmf.la libwmf.la $(XFLIBS)

wmftoeps: libwmf.la libepswmf.la wmftoeps.o libxfig/libeps.la
	./libtool $(CC) $(LDFLAGS) -o wmftoeps wmftoeps.o \
		libepswmf.la libwmf.la $(EPSLIBS)

libwmf.la:	$(WMFLIBOBJECTS)
	./libtool $(CC) -o libwmf.la $(WMFLIBOBJECTS) \
		-rpath $(libdir) -version-info 0:0:0

libgdwmf.la:	$(GDLIBOBJECTS)
	./libtool $(CC) -o libgdwmf.la $(GDLIBOBJECTS) \
		-rpath $(libdir) -version-info 0:0:0

libxfwmf.la:	$(XFLIBOBJECTS)
	./libtool $(CC) -o libxfwmf.la $(XFLIBOBJECTS) \
		-rpath $(libdir) -version-info 0:0:0

libepswmf.la:	$(EPSLIBOBJECTS)
	./libtool $(CC) -o libepswmf.la $(EPSLIBOBJECTS) \
		-rpath $(libdir) -version-info 0:0:0

libXwmf.la:	$(XLIBOBJECTS)
	./libtool $(CC) -o libXwmf.la $(XLIBOBJECTS) \
		-rpath $(libdir) -version-info 0:0:0

libdib/libdib.la:
	@echo making libdib in libdib
	@(cd libdib && $(MAKE)) || exit 1

xgd-1.7.3/libxgd.la:
	@echo making libxgd in xgd-1.7.3
	@(cd xgd-1.7.3 && $(MAKE)) || exit 1

libxfig/libxfig.la libxfig/libeps.la:
	@echo making libxfig, libeps in libxfig
	@(cd libxfig && $(MAKE)) || exit 1

.c.o:
	$(CC) $(CFLAGS) -c $<

.c.lo:
	./libtool $(CC) $(CFLAGS) -c $<

clean: cleansub
	rm -rf *.o *.lo wmftopng wmftofig wmftoeps xwmf core *.a *.la .libs .pure

cleansub:
	@echo cleaning libdib in libdib
	@(cd libdib && $(MAKE) clean) || exit 1
	@echo cleaning libxgd in xgd-1.7.3
	@(cd xgd-1.7.3 && $(MAKE) clean) || exit 1
	@echo cleaning libxfig, libeps in libxfig
	@(cd libxfig && $(MAKE) clean) || exit 1

installsub:
	@echo installing libdib from libdib
	@(cd libdib && $(MAKE) install) || exit 1
	@echo installing libxgd from xgd-1.7.3
	@(cd xgd-1.7.3 && $(MAKE) install) || exit 1
	@echo installing libxfig.a, libeps.a from libxfig
	@(cd libxfig && $(MAKE) install) || exit 1

distclean: realclean

realclean: realcleansub
	rm -rf config.cache config.status config.log Makefile config.h libtool *.o *.lo wmftopng wmftofig wmftoeps xwmf *.a *.la .libs core .pure

realcleansub:
	@echo cleaning libdib in libdib
	@(cd libdib && $(MAKE) realclean) || exit 1
	@echo cleaning libxgd in xgd-1.7.3
	@(cd xgd-1.7.3 && $(MAKE) realclean) || exit 1
	@echo cleaning libxfig, libeps in libxfig
	@(cd libxfig && $(MAKE) realclean) || exit 1

installdirs:
	$(MKINSTALLDIRS) $(bindir) \
	$(libdir)

install: all installdirs installsub
	./libtool $(INSTALL) $(srcdir)/libwmf.la $(libdir)/libwmf.la
	./libtool $(INSTALL) $(srcdir)/libgdwmf.la $(libdir)/libgdwmf.la
	./libtool $(INSTALL) $(srcdir)/libXwmf.la $(libdir)/libXwmf.la
	./libtool $(INSTALL) $(srcdir)/libxfwmf.la $(libdir)/libxfwmf.la
	./libtool $(INSTALL) $(srcdir)/libepswmf.la $(libdir)/libepswmf.la
	./libtool --finish $(libdir)
	./libtool $(INSTALL) $(srcdir)/xwmf $(bindir)/xwmf
	./libtool $(INSTALL) $(srcdir)/wmftopng $(bindir)/wmftopng
	./libtool $(INSTALL) $(srcdir)/wmftofig $(bindir)/wmftofig
	./libtool $(INSTALL) $(srcdir)/wmftoeps $(bindir)/wmftoeps
	$(INSTALL_DATA) wmfapi.h $(INCLUDEDIR)/wmfapi.h
	$(INSTALL_DATA) gdwmfapi.h $(INCLUDEDIR)/gdwmfapi.h
	$(INSTALL_DATA) Xwmfapi.h $(INCLUDEDIR)/Xwmfapi.h

#  DO  NOT  DELETE THIS LINE -- make depend depends on it.
