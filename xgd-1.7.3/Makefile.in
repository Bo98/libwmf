top_builddir = ..

#Depending on your system, you will need to modify this makefile.

#If you do not have gcc, change the setting for COMPILER, but you must
#use an ANSI standard C compiler (NOT the old SunOS 4.1.3 cc
#compiler; get gcc if you are still using it). 
COMPILER=@CC@

#If the install command is not in your path, provide
#an explicit path for it here, or install manually.
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@

@SET_MAKE@

prefix=@prefix@
exec_prefix=@exec_prefix@
srcdir=@srcdir@
bindir=@bindir@
libdir=@libdir@
mandir=@mandir@
includedir = @includedir@

VPATH = @srcdir@


#If you don't have FreeType and/or Xpm installed, including the
#header files, uncomment this (default).
CFLAGS=@CPPFLAGS@ @CFLAGS@ @DEFS@ -I../ @PNG_CFLAGS@ @ZLIB_CFLAGS@ @TTF_CFLAGS@ @XPM_CFLAGS@
#If you do have FreeType and/or Xpm fully installed, uncomment a
#variation of this and comment out the line above. See also LIBS below.
#CFLAGS=-O -DHAVE_XPM -DHAVE_LIBTTF

#If you don't have FreeType and/or Xpm fully installed, uncomment this
#(default).
LIBS= libxgd.la @PNG_LIBS@ @ZLIB_LIBS@ @TTF_LIBS@ @XPM_LIBS@ @X_LIBS@ @X11@ @X_EXTRA_LIBS@ -lm

#If you do have FreeType and/or Xpm fully installed, uncomment a 
#variation of this and comment out the line above. Note that
#Xpm requires X11. See also CFLAGS above.
#LIBS=-lm libxgd.la -lpng -lz -lttf -lXpm -lX11

#Typical install locations for freetype, zlib, xpm and libpng header files.
#If yours are somewhere else, change this. 
INCLUDEDIRS=

#Typical install locations for freetype, zlib, xpm and libpng libraries.
#If yours are somewhere else, other than a standard location
#such as /lib or /usr/lib, then change this.
LIBDIRS=@LDFLAGS@

#Location where libxgd.a should be installed by "make install".
INSTALL_LIB=@libdir@

#Location where .h files should be installed by "make install".
INSTALL_INCLUDE=@includedir@

#Location where useful non-test programs should be installed by "make install".
INSTALL_BIN=@bindir@

#
#
# Changes should not be required below here.
#
#

VERSION=1.7

CC=$(COMPILER) $(INCLUDEDIRS)
LINK=$(CC) $(LIBDIRS) $(LIBS)

.SUFFIXES:
.SUFFIXES: .c .o .lo

PROGRAMS=$(BIN_PROGRAMS) $(TEST_PROGRAMS)

BIN_PROGRAMS=pngtogd pngtogd2 gdtopng gd2topng gd2copypal gdparttopng webpng
TEST_PROGRAMS=gdtest gddemo gd2time gdtestttf

all: libxgd.la $(PROGRAMS)

install: libxgd.la $(BIN_PROGRAMS)
	../libtool $(INSTALL) libxgd.la $(INSTALL_LIB)/libxgd.la
	../libtool --finish $(libdir)
	../libtool $(INSTALL) pngtogd $(INSTALL_BIN)/pngtogd
	../libtool $(INSTALL) pngtogd2 $(INSTALL_BIN)/pngtogd2
	../libtool $(INSTALL) gdtopng $(INSTALL_BIN)/gdtopng
	../libtool $(INSTALL) gd2topng $(INSTALL_BIN)/gd2topng
	../libtool $(INSTALL) gd2copypal $(INSTALL_BIN)/gd2copypal
	../libtool $(INSTALL) gdparttopng $(INSTALL_BIN)/gdparttopng
	../libtool $(INSTALL) webpng $(INSTALL_BIN)/webpng
	../libtool $(INSTALL) bdftogd $(INSTALL_BIN)/bdftogd
	$(INSTALL_DATA) gd.h $(INSTALL_INCLUDE)/gd.h
	$(INSTALL_DATA) gdcache.h $(INSTALL_INCLUDE)/gdcache.h
	$(INSTALL_DATA) gd_io.h $(INSTALL_INCLUDE)/gd_io.h
	$(INSTALL_DATA) gdfontg.h $(INSTALL_INCLUDE)/gdfontg.h
	$(INSTALL_DATA) gdfontl.h $(INSTALL_INCLUDE)/gdfontl.h
	$(INSTALL_DATA) gdfontmb.h $(INSTALL_INCLUDE)/gdfontmb.h
	$(INSTALL_DATA) gdfonts.h $(INSTALL_INCLUDE)/gdfonts.h
	$(INSTALL_DATA) gdfontt.h $(INSTALL_INCLUDE)/gdfontt.h

gddemo: gddemo.o libxgd.la
	../libtool $(CC) gddemo.o -o gddemo	$(LIBDIRS) $(LIBS)

pngtogd: pngtogd.o libxgd.la
	../libtool $(CC) pngtogd.o -o pngtogd	$(LIBDIRS) $(LIBS) 

webpng: webpng.o libxgd.la
	../libtool $(CC) webpng.o -o webpng	$(LIBDIRS) $(LIBS)

pngtogd2: pngtogd2.o libxgd.la
	../libtool $(CC) pngtogd2.o -o pngtogd2	$(LIBDIRS) $(LIBS)

gdtopng: gdtopng.o libxgd.la
	../libtool $(CC) gdtopng.o -o gdtopng	$(LIBDIRS) $(LIBS)

gd2topng: gd2topng.o libxgd.la
	../libtool $(CC) gd2topng.o -o gd2topng	$(LIBDIRS) $(LIBS)

gd2copypal: gd2copypal.o libxgd.la
	../libtool $(CC) gd2copypal.o -o gd2copypal	$(LIBDIRS) $(LIBS)

gdparttopng: gdparttopng.o libxgd.la
	../libtool $(CC) gdparttopng.o -o gdparttopng	$(LIBDIRS) $(LIBS)

gdtest: gdtest.o libxgd.la
	../libtool $(CC) gdtest.o -o gdtest	$(LIBDIRS) $(LIBS)

gd2time: gd2time.o libxgd.la
	../libtool $(CC) gd2time.o -o gd2time	$(LIBDIRS) $(LIBS)

gdtestttf: gdtestttf.o libxgd.la
	../libtool $(CC) gdtestttf.o -o gdtestttf	$(LIBDIRS) $(LIBS)

libxgd.la: gd.lo gd_gd.lo gd_gd2.lo gd_io.lo gd_io_dp.lo gd_io_file.lo \
	gd_ss.lo gd_io_ss.lo gd_png.lo gdxpm.lo gdfontt.lo gdfonts.lo \
	gdfontmb.lo gdfontl.lo gdfontg.lo gdtables.lo gdttf.lo gdcache.lo \
	gdkanji.lo gd.h gdfontt.h gdfonts.h gdfontmb.h gdfontl.h gdfontg.h
	../libtool $(CC) -o libxgd.la gd.lo gd_gd.lo gd_gd2.lo gd_io.lo \
		gd_io_dp.lo gd_io_file.lo gd_ss.lo gd_io_ss.lo gd_png.lo \
		gdxpm.lo gdfontt.lo gdfonts.lo gdfontmb.lo gdfontl.lo \
		gdfontg.lo gdtables.lo gdttf.lo gdcache.lo gdkanji.lo \
		-rpath $(libdir) -version-info 0:0:0

.c.o:
	$(CC) $(CFLAGS) -c $<

.c.lo:
	../libtool $(CC) $(CFLAGS) -c $<

clean:
	rm -rf *.o *.lo *.a *.la .libs ${PROGRAMS} core 

realclean:
	rm -rf *.o *.lo *.a *.la .libs ${PROGRAMS} core Makefile

# Do not delete this line -- make depends on it.
